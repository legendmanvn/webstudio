var DepartmentManagement;jQuery.template("userActionMenuTemplate",'<ul class="dropdown-content">{{if ($data.canEdit === "true") && ($data.isAdmin === true || $data.isMe === true ) && (user.status !== "blocked")}}<li><a class="edit-profile dropdown-item">${ASC.People.Resources.PeopleResource.LblEdit}<\/a><\/li>{{/if}}        {{if ($data.canDel === "true") && ($data.isAdmin === true) && (user.status === "blocked")}}<li><a class="enable-profile dropdown-item">${ASC.People.Resources.PeopleResource.EnableUserButton}<\/a><\/li>{{/if}}        {{if ($data.canEdit === "true") && ($data.isAdmin === true || $data.isMe === true) && (user.status !== "blocked") && (user.status !== "waited") && (user.isLDAP === "false") && (user.isSSO === "false")}}<li><a class="change-password dropdown-item">${ASC.People.Resources.PeopleResource.LblChangePassword}<\/a><\/li>{{/if}}        {{if ($data.isAdmin === true || $data.isMe === true) && (user.status !== "blocked") && (user.status !== "waited") && (user.isLDAP === "false") && (user.isSSO === "false")}}<li><a class="change-email dropdown-item">${ASC.People.Resources.PeopleResource.LblChangeEmail}<\/a><\/li>{{/if}}        {{if ($data.isAdmin === true || $data.isMe === true) && (user.status === "waited")}}<li><a class="email-activation dropdown-item">${ASC.People.Resources.PeopleResource.LblSendActivation}<\/a><\/li>{{/if}}        {{if ($data.canDel === "true") && ($data.isAdmin === true) && ($data.isMe !== true) && (user.status !== "blocked") && (user.isLDAP === "false")}}<li><a class="block-profile dropdown-item">${ASC.People.Resources.PeopleResource.DisableUserButton}<\/a><\/li>{{/if}}        {{if (user.isOwner !== "true") && ($data.canDel === "true") && ($data.isAdmin === true) && (user.status === "blocked") && (user.isLDAP === "false")}}<li><a class="reassign-data dropdown-item">${ASC.People.Resources.PeopleResource.LblReassignData}<\/a><\/li>{{/if}}        {{if (user.isOwner !== "true") && ((($data.canDel === "true") && ($data.isAdmin === true) && (user.status === "blocked") && (user.isLDAP === "false")) || ($data.isMe === true) && (user.isLDAP === "false"))}}<li><a class="delete-profile dropdown-item">${ASC.People.Resources.PeopleResource.LblDeleteProfile}<\/a><\/li>{{/if}}<\/ul>');jQuery.template("userListTemplate",'{{each(i, user) users}}<tr id="user_${user.id}" class="item profile {{if ($data.isAdmin === true || user.isMe === true) && (user.isMe === true || user.isPortalOwner !== true)}} with-entity-menu {{/if}} {{if user.isTerminated}} blocked{{else user.isActivated === false}} waited{{/if}} {{if user.isChecked == true}} selected{{/if}}"        data-id="${user.id}"        data-username="${user.userName}"        data-email="${user.email}"        data-displayname="${user.displayName}"        data-status="{{if user.isTerminated}}blocked{{else user.isActivated === false}}waited{{/if}}"        data-isAdmin="${user.isAdmin}"        data-isOwner="${user.isPortalOwner}"        data-isVisitor="${user.isVisitor}"        data-isLDAP="${user.isLDAP}"        data-isSSO="${user.isSSO}">{{if ($data.isAdmin === true)}}<td class="check-list" id="checkRow_${user.id}"><input type="checkbox" id="checkUser_${user.id}" class="checkbox-user"                   {{if user.isChecked== true}}checked="checked"{{/if}}/><\/td>{{/if}}<td class="icon-list"><a class="ava" href="${user.link}"><img src="${user.avatarSmall}" title="${user.displayName}"/>{{if (user.isVisitor)}}<span class="role collaborator" title="${ASC.Resources.Master.Guest}"><\/span>{{/if}}                {{if (user.isAdmin || listAdminModules.length) && (!user.isPortalOwner)}}<span class="role admin" title="${ASC.Resources.Master.TemplateResource.Administrator}"><\/span>{{/if}}                {{if (user.isPortalOwner)}}<span class="role owner" title="${ASC.Resources.Master.TemplateResource.Owner}"><\/span>{{/if}}                {{if (user.isTerminated || user.isActivated === false)}}<span class="status"><\/span>{{/if}}<\/a><\/td><td class="name"><a class="link bold" href="${user.link}">${user.displayName}<\/a>{{if ($data.isAdmin === true || $data.isPortalOwner === true)}}                {{if (user.isLDAP === true)}}<span class="ldap-lock" title="${ASC.Resources.Master.LdapUsersListLockTitle}"><\/span>{{else}}                    {{if (user.isSSO === true)}}<span class="sso-lock" title="${ASC.Resources.Master.SsoUsersListLockTitle}"><\/span>{{/if}}                {{/if}}            {{/if}}            {{if user.bithdayDaysLeft != null}}<div class="birthday">{{if user.bithdayDaysLeft == 0}}${ASC.Resources.Master.TemplateResource.DrnToday}        {{else user.bithdayDaysLeft==1}}${ASC.Resources.Master.TemplateResource.DrnTomorrow}        {{else user.bithdayDaysLeft==2}}${ASC.Resources.Master.TemplateResource.In} ${ASC.Resources.Master.TemplateResource.Yet2}        {{else user.bithdayDaysLeft==3}}${ASC.Resources.Master.TemplateResource.In} ${ASC.Resources.Master.TemplateResource.Yet3}        {{/if}}<\/div>{{/if}}<div class="title">{{if user.isGroupManager && user.title.length}}<span class="inner-text manager">${Encoder.htmlEncode(user.title, true)}<\/span>{{else}}<span class="inner-text">${Encoder.htmlEncode(user.title, true)}<\/span>{{/if}}<\/div><\/td><td class="group">{{if user.groups.length === 1 && user.group != null}}<a class="link dotted text-overflow" title="${user.group.name}" href="#group=${user.group.id}">${user.group.name}<\/a>{{else user.groups.length > 1}}<span id="peopleGroupsSwitcher_${user.id}" class="withHoverArrowDown"><span class="link dotted">${user.groups.length} ${ASC.Resources.Master.Departments}<\/span><\/span><div id="peopleGroups_${user.id}" class="studio-action-panel"><ul class="dropdown-content">{{each(i, gr) user.groups}}<li><a class="dropdown-item" href="#group=${gr.id}">${gr.name}<\/a><\/li>{{/each}}<\/ul><\/div>{{/if}}<\/td><td class="location"><span class="inner-text">${Encoder.htmlEncode(user.location, true)}<\/span><\/td><td class="info">{{if user.isTerminated}}<span class="red-text">${ASC.People.Resources.PeopleResource.BlockedMessage}<\/span>{{else}}          {{if user.isActivated === false && user.email}}<span class="email gray-text">${ASC.People.Resources.PeopleResource.WaitingForConfirmation}<\/span>{{/if}}       {{/if}}      {{if user.isActivated && !user.isTerminated && user.email}}<div id="peopleEmail_${id}" class="btn email"><span class="link dotted">${user.email}<\/span><\/div><div id="peopleEmailSwitcher_${id}" class="studio-action-panel"><ul class="dropdown-content"><li><a class="send-email dropdown-item">${ASC.People.Resources.PeopleResource.LblSendEmail}<\/a><\/li>{{if !user.isMe && !user.isTerminated}}<li><a class="open-dialog dropdown-item">${ASC.People.Resources.PeopleResource.LblSendMessage}<\/a><\/li>{{/if}}<\/ul><\/div>{{else}}        &nbsp;      {{/if}}<\/td><td class="menu-action-list">{{if ($data.isAdmin === true || user.isMe === true) && (user.isMe === true || user.isPortalOwner !== true)}}<div id="peopleMenu_${id}" class="entity-menu" title="${ASC.People.Resources.PeopleResource.Actions}"><\/div>{{/if}}<\/td><\/tr>{{/each}}');jQuery.template("depAddPopupBodyTemplate",'<div class="clearFix block-cnt-splitter requiredField" ><span class="requiredErrorText">${ASC.People.Resources.PeopleResource.ErrorEmptyName}<\/span><div class="headerPanelSmall header-base-small">${ASC.People.Resources.PeopleResource.Title}:<\/div><input type="text" id="studio_newDepName" class="textEdit" style="width: 99%;" maxlength="100" /><\/div><div class="clearFix block-cnt-splitter"><div class="headerPanelSmall header-base-small">${ASC.People.Resources.DepartmentMaster}:<\/div><span id="headAdvancedSelector" class="link dotline plus">${ASC.Resources.Master.ChooseUser}<\/span><div id="departmentManager" class="advanced-selector-select-result display-none"><span class="result-name" data-id=""><\/span><span class="reset-icon"><\/span><\/div><\/div><div class="clearFix"><div class="headerPanelSmall header-base-small" >${ASC.People.Resources.PeopleResource.Members}:<\/div><span id="membersAdvancedSelector" class="link dotline plus">${ASC.People.Resources.PeopleResource.AddMembers}<\/span><div class="members-dep-list"><ul id="membersDepartmentList" class="advanced-selector-list-results"><\/ul><\/div><\/div><div id="depActionBtn" class="middle-button-container"><a class="button blue middle">${ASC.People.Resources.PeopleResource.AddButton}<\/a><span class="splitter-buttons"><\/span><a class="button gray middle">${ASC.People.Resources.PeopleResource.CancelButton}<\/a><\/div>');var PeopleManager=new function(){this.GroupHeader="";this.SelectedCount="";this.UserLimit=""},ga_Categories={people:"people_list"},ga_Actions={filterClick:"filter-click",createNew:"create-new",remove:"remove",edit:"edit",view:"view",changeStatus:"change-status",next:"next",userClick:"user-click",actionClick:"action-click",quickAction:"quick-action",bannerClick:"banner-click"};(function(){function n(n,t){jq("#peopleFilter").advansedFilter({nonetrigger:!0,hintDefaultDisable:!0,sorters:[{id:"by-name",dsc:t.sortorder}],filters:[{id:"text",params:{value:t.query}},{id:"selected-group",params:t.groupId?{id:t.groupId}:null},{id:"selected-status-active",params:t.status?{value:t.status}:null},{id:"selected-status-pending",params:t.status?{value:t.status}:null},{id:"selected-status-disabled",params:t.status?{value:t.status}:null},{id:"selected-type-admin",params:t.type?{value:t.type}:null},{id:"selected-type-user",params:t.type?{value:t.type}:null},{id:"selected-type-visitor",params:t.type?{value:t.type}:null}]});(t.groupId||t.status||t.type)&&jq("#peopleFilter").addClass("has-filters")}jq(window).bind("people-render-profiles",n)})();typeof ASC=="undefined"&&(ASC={});typeof ASC.People=="undefined"&&(ASC.People={});ASC.People.PageNavigator=function(){var n,t,i=function(){function u(i,r){var u=r.__total||r.__count;n.drawPageNavigator(r.page,u);t||(t=jq("#totalUsers"));t.text(u)}var i=ASC.People,r=i.Resources;n=new ASC.Controls.PageNavigator.init("ASC.People.PageNavigator.pgNavigator","#peoplePageNavigator",25,3,1,r.PreviousPage,r.NextPage);n.changePageCallback=function(n){i.PeopleController.moveToPage(n)};jq(window).bind("people-render-profiles",u)};return{init:i,get pgNavigator(){return n}}}();jq(document).ready(function(){ASC.People.PageNavigator.init()});typeof ASC=="undefined"&&(ASC={});typeof ASC.People=="undefined"&&(ASC.People=function(){return{}}());ASC.People.PeopleController=function(){function g(){LoadingBanner.displayLoading()}function nt(){LoadingBanner.hideLoading()}function vt(){jq(".mainPageContent").children(".loader-page").css({top:jq(window).height()/2+"px"})}function yt(){d=!1;jq(".mainPageContent").children(".loader-page").remove();jq(".profile-title, #filterContainer, #tableForPeopleNavigation").show();jq("#peopleFilter").advansedFilter("resize")}function h(n){var e=[],o=864e5,i=new Date,c=-i.getTimezoneOffset()*6e4,u,f,s,t,r,h;for(i.setHours(00),i.setMinutes(00),i.setSeconds(00),f=0,s=n.length;f<s;f++)t=n[f],t.displayName=t.displayName,t.group=t.groups.length>0?{id:t.groups[0].id,name:t.groups[0].name}:null,t.link="profile.aspx?user="+encodeURIComponent(t.userName),r=t.birthday,r!=null&&r.getFullYear()<=i.getFullYear()&&(r=new Date(r.getTime()+c),h=new Date(i.getFullYear(),i.getMonth()+1,0).getDate(),h>=r.getDate()&&(r.setFullYear(i.getFullYear()),u=Math.round((r.getTime()-i.getTime())/o),u<0&&r.setFullYear(i.getFullYear()+1),u>=0&&u<4&&(t.bithdayDaysLeft=Math.round((r.getTime()-i.getTime())/o)))),e.push(t);return e}function pt(n){var t,i;n=n||{};n.sortby="displayname";n.fields="id,status,isAdmin,isOwner,isVisitor,activationStatus,userName,email,displayName,avatarSmall,listAdminModules,birthday,title,groups,location,isLDAP,isSSO";t=jq.anchorToObject(ASC.Controls.AnchorController.getAnchor());for(i in t)if(t.hasOwnProperty(i))switch(i){case"sortorder":n.sortorder=t[i];break;case"query":n.filtervalue=decodeURIComponent(t[i]);break;case"group":n.groupId=t[i];break;case"status":n.status=t[i];break;case"type":n.type=t[i]}if(n.hasOwnProperty("status")){switch(n.status){case"active":n.employeestatus=1;n.activationstatus=1;break;case"disabled":n.employeestatus=2;break;case"pending":n.activationstatus=2}delete n.status}if(n.hasOwnProperty("type")){switch(n.type){case"user":n.employeeType=1;break;case"visitor":n.employeeType=2;break;case"admin":n.isadministrator=!0}delete n.type}return n}function ft(n){n.filter("tr.profile").each(function(){var t=jq(this),n=jq(this).attr("data-id"),u=t.find("td.info:first [id^='peopleEmailSwitcher'] .dropdown-item"),r,i;u.bind("click",bt);r=t.find(".btn.email:first");r.length==1&&jq.dropdownToggle({dropdownID:"peopleEmailSwitcher_"+n,switcherSelector:"#peopleEmail_"+n,addTop:4,addLeft:17,rightPos:!0,showFunction:function(){jq(this).parents("tr.profile:first").addClass("hover")},hideFunction:function(){jq(this).parents("tr.profile:first").removeClass("hover")}});i=t.find("td.group:first .withHoverArrowDown");i.length==1&&jq.dropdownToggle({dropdownID:"peopleGroups_"+n,switcherSelector:"#peopleGroupsSwitcher_"+n,addTop:4,addLeft:17,rightPos:!0,showFunction:function(n,t){t.is(":hidden")?n.addClass("active"):n.removeClass("active")},hideFunction:function(){i.removeClass("active")}})})}function wt(t,i){for(var f,e,c,s,h=[],r=0,o=n.length;r<o;r++)h.push(n[r].id);for(f=!1,e=jq.getAnchorParam("group",ASC.Controls.AnchorController.getAnchor()),r=0,o=i.length;r<o;r++)c=jq.inArray(i[r].id,h),i[r].isChecked=c!=-1,i[r].isGroupManager=i[r].groups.some(function(n){return e?e==n.id&&n.manager==i[r].userName:n.manager==i[r].userName}),f=f||i[r].isGroupManager;e&&f&&(i=i.sort(function(n){return-1*n.isGroupManager}));u=i;s=jq.tmpl("userListTemplate",{users:i,isAdmin:Teamlab.profile.isAdmin||window.ASC.Resources.Master.IsProductAdmin});jq("#peopleData tbody").empty().append(s);ft(jq(s));jq(window).trigger("people-render-profiles",[t,i]);lt();bi()}function kt(n,t){t=h(t);t!=null&&t.length>0?(wt(n,t),jq("#emptyContentForPeopleFilter").addClass("display-none"),jq("#peopleContent").removeClass("display-none"),vi()):(jq(window).trigger("people-render-profiles",[n,t]),jq("#peopleContent").addClass("display-none"),jq("#emptyContentForPeopleFilter").removeClass("display-none"));jq("#peopleHeaderMenu .on-top-link").click()}function dt(){window.location.href=jq.clearUrl()}function gt(n,t){DepartmentManagement.EditDepartmentOpenDialog(t.id,t.name,t.manager)}function ni(n,t){return n==null||t==null?!1:(n=jq.removeParam("p",n),n=jq.removeParam("c",n),n=jq.removeParam("sortorder",n),n=jq.removeParam("query",n),t=jq.removeParam("p",t),t=jq.removeParam("c",t),t=jq.removeParam("sortorder",t),t=jq.removeParam("query",t),jq.isEqualAnchors(jq.anchorToObject(t),jq.anchorToObject(n)))}function ti(){var n=ASC.Controls.AnchorController.getAnchor(),t,u,s,e,f,h;if(r===n)return undefined;if(t=jq.anchorToObject(n),u=r!=null?jq.anchorToObject(r):null,!t.hasOwnProperty("sortorder"))if(u!=null&&u.hasOwnProperty("sortorder"))t.sortorder=u.sortorder;else if(t.sortorder="ascending",u==null&&(Teamlab.profile.isAdmin||window.ASC.Resources.Master.IsProductAdmin)){for(s=!1,e=ASC.Resources.Master.ApiResponses_ActiveProfiles.response,f=0,h=e.length;f<h;f++)if(e[f].isActivated===!0&&e[f].isOwner===!1){s=!0;break}s&&(t.status="active")}n=jq.objectToAnchor(t);ni(r,n)||(n=jq.removeParam("p",n),n=jq.removeParam("c",n));ASC.Controls.AnchorController.safemove(n);r=n;i.CurrentPageNumber=1;o(1,"pageOfProfilesList");tt();jq(window).trigger("change-group",[jq.getAnchorParam("group")||null])}function ii(){var n=jq.getAnchorParam("group")||null;n!=null&&Teamlab.getGroup({},n,{filter:null,before:g,after:nt,success:gt})}function et(t,i,r){var u,f;if(jq("#peopleActionMenu").hide(),jq("#peopleMenu_"+t).removeClass("active"),i==1&&s.availableUsersCount==0&&r=="false"){jq("#tariffLimitExceedUsersPanel").length&&TariffLimitExceed.showLimitExceedUsers();return}u=[];u.push(t);f={userIds:u};Teamlab.updateUserStatus({},i,f,{success:function(t,i){var u=h(i),r,f;for(rt(t,u),r=0,f=u.length;r<f;r++)jq.inArray(u[r],n)==-1&&n.push(u[r]);c();toastr.success(ASC.People.Resources.PeopleJSResource.SuccessChangeUserStatus);k()},before:g,after:nt,error:function(n,t){toastr.error(t)}})}function ot(n){var t=jq("#user_"+n),i=t.attr("data-email"),u=t.attr("data-username"),s=t.attr("data-displayname"),h=t.attr("data-status"),c=t.attr("data-isOwner"),f=t.attr("data-isVisitor"),r=jq("#peopleActionMenu"),l=r.attr("data-canedit").toLowerCase(),a=r.attr("data-candel").toLowerCase(),v=t.attr("data-isLDAP"),y=t.attr("data-isSSO"),e={id:n,email:i,username:u,status:h,isOwner:c,isLDAP:v,isSSO:y},p=jq.tmpl("userActionMenuTemplate",{user:e,isAdmin:Teamlab.profile.isAdmin||window.ASC.Resources.Master.IsProductAdmin,isMe:e.id===Teamlab.profile.id,canEdit:l,canDel:a}),o;r.html(p);o=r.find(".dropdown-item");o.on("click",function(e){var o=jq(e.target);r.hide();jq("#peopleMenu_"+n).removeClass("active");jq(this).hasClass("edit-profile")?window.location.replace("profileaction.aspx?action=edit&user="+encodeURIComponent(u)):jq(this).hasClass("change-password")?PasswordTool.ShowPwdReminderDialog("1",i):jq(this).hasClass("change-email")?ASC.EmailOperationManager.showEmailChangeWindow(i,n):jq(this).hasClass("email-activation")?ASC.EmailOperationManager.sendEmailActivationInstructions(i,n,function(n){t.attr("data-email",n.request.args.email)}):jq(this).hasClass("block-profile")?et(n,2,f):jq(this).hasClass("enable-profile")?et(n,1,f):jq(this).hasClass("reassign-data")?window.location.replace("reassigns.aspx?user="+encodeURIComponent(u)):jq(this).hasClass("delete-profile")&&(n==Teamlab.profile.id?(jq("#studio_deleteProfileDialog").find(".email").attr("href","../../addons/mail/#composeto/email="+i).html(i),StudioBlockUIManager.blockUI("#studio_deleteProfileDialog",400,300,0)):ProfileManager.RemoveUser(n,s,u))})}function ri(){var t=jq("#peopleActionMenu"),n;t.length==1&&(n=-200,jq.dropdownToggle({dropdownID:"peopleActionMenu",switcherSelector:"#peopleData .entity-menu",addTop:0,addLeft:n,fixWinSize:!0,showFunction:function(t,i){var r=t.attr("id").split("_")[1],u;r&&(ot(r),t.addClass("active"),u=parseInt(i.css("left"))-i.innerWidth()+29-n,i.css("left",u),jq("#peopleData .entity-menu.active").length>1?(jq("#peopleData .entity-menu.active").not(t).removeClass("active"),i.hide()):i.is(":hidden")||t.removeClass("active"))},hideFunction:function(){jq("#peopleData .entity-menu.active").removeClass("active")}}))}function ui(){jq.tmpl("template-blockUIPanel",{id:"confirmationDeleteDepartmentPanel",headerTest:ASC.People.Resources.PeopleResource.Confirmation,innerHtmlText:'<div class="confirmationAction"><\/div>',OKBtn:ASC.People.Resources.PeopleResource.LblOKButton,CancelBtn:ASC.People.Resources.PeopleResource.LblCancelButton}).insertAfter("#peopleActionMenu");jq.tmpl("template-blockUIPanel",{id:"studio_deleteProfileDialog",headerTest:jq("#studio_deleteProfileDialogBody").attr("data-header")}).insertAfter("#studio_deleteProfileDialogBody");jq("#studio_deleteProfileDialog .containerBodyBlock:first").replaceWith(jq("#studio_deleteProfileDialogBody").removeClass("display-none").addClass("containerBodyBlock"));(Teamlab.profile.isAdmin||window.ASC.Resources.Master.IsProductAdmin)&&(jq("#changeTypeDialogBody").length==1&&(jq.tmpl("template-blockUIPanel",{id:"changeTypeDialog",headerTest:ASC.People.Resources.PeopleResource.ChangeTypeDialogHeader}).insertAfter("#changeTypeDialogBody"),jq("#changeTypeDialog .containerBodyBlock:first").replaceWith(jq("#changeTypeDialogBody").removeClass("display-none").addClass("containerBodyBlock"))),jq("#changeStatusDialogBody").length==1&&(jq.tmpl("template-blockUIPanel",{id:"changeStatusDialog",headerTest:ASC.People.Resources.PeopleResource.ChangeStatusDialogHeader}).insertAfter("#changeStatusDialogBody"),jq("#changeStatusDialog .containerBodyBlock:first").replaceWith(jq("#changeStatusDialogBody").removeClass("display-none").addClass("containerBodyBlock"))),jq.tmpl("template-blockUIPanel",{id:"deleteUsersDialog",headerTest:ASC.People.Resources.PeopleResource.DeleteUserProfiles,innerHtmlText:['<div class="confirmationAction">',ASC.People.Resources.PeopleResource.DeleteUsersDescriptionText,"<\/div>","<div>",ASC.People.Resources.NotBeUndone,"<\/div>",'<div class="warning-header red-text">',ASC.People.Resources.Warning,"<\/div>",'<div class="confirmationAction">',ASC.People.Resources.PeopleResource.DeleteUsersDataConfirmation,"<\/div>",'<a class="link dotline showBtn">',ASC.People.Resources.PeopleResource.ShowSelectedUserList,"<\/a>",'<a class="link dotline hideBtn display-none">',ASC.People.Resources.PeopleResource.HideSelectedUserList,"<\/a>",'<div class="user-list-for-group-operation display-none"><\/div>','<div class="error-popup display-none"><\/div>'].join(""),OKBtn:ASC.People.Resources.PeopleResource.LblOKButton,CancelBtn:ASC.People.Resources.PeopleResource.LblCancelButton}).insertAfter("#changeTypePanel"),jq.tmpl("template-blockUIPanel",{id:"resendInviteDialog",headerTest:ASC.People.Resources.PeopleResource.ResendInviteDialogHeader,innerHtmlText:["<div>",ASC.People.Resources.PeopleResource.ResendInviteDialogTargetUsers,"<\/div>","<div>",ASC.People.Resources.PeopleResource.ResendInviteDialogAfterActivation,"<\/div>",'<a class="link dotline showBtn">',ASC.People.Resources.PeopleResource.ShowSelectedUserList,"<\/a>",'<a class="link dotline hideBtn display-none">',ASC.People.Resources.PeopleResource.HideSelectedUserList,"<\/a>",'<div class="user-list-for-group-operation display-none"><\/div>','<div class="error-popup display-none"><\/div>'].join(""),OKBtn:ASC.People.Resources.PeopleResource.LblOKButton,OKBtnID:"resentInviteOkBtn",CancelBtn:ASC.People.Resources.PeopleResource.LblCancelButton,CancelBtnID:"resentInviteCancelBtn"}).insertAfter("#changeTypePanel"))}function fi(){jq.tmpl("template-emptyScreen",{ID:"emptyContentForPeopleFilter",ImgSrc:ASC.People.Data.emptyScreenPeopleFilter,Header:ASC.People.Resources.PeopleResource.NotFoundTitle,Describe:ASC.People.Resources.PeopleResource.NotFoundDescription,ButtonHTML:["<a class='clearFilterButton link dotline' href='javascript:void(0);'","onclick='ASC.People.PeopleController.resetAllFilters();'>",ASC.People.Resources.PeopleResource.ClearButton,"<\/a>"].join(""),CssClass:"display-none"}).insertAfter("#peopleContent")}function tt(){var t=jq.cookies.get("countOfProfilesList"),s,h;t&&(i.EntryCountOnPage=t.key);t=jq.cookies.get("pageOfProfilesList");t&&(i.CurrentPageNumber=t.key);var r=i.EntryCountOnPage,n=i.CurrentPageNumber,f=jq.getAnchorParam("type")||null,u=jq.getAnchorParam("status")||null,e=jq.getAnchorParam("group")||null,c=jq.getAnchorParam("sortorder")=="descending"||!1,o=decodeURIComponent(jq.getAnchorParam("query"));n=isFinite(+n)?+n:0;jq("#countOfRows").val(r).tlCombobox();s={page:n,type:f,status:u,groupId:e,query:o};h=pt({StartIndex:(n>0?n-1:n)*r,Count:r,sortorder:c,status:u});Teamlab.getProfilesByFilter(s,{filter:h,before:function(){d||g()},after:function(){d?yt():nt()},success:kt});f||u||e||o.length||jq("#peopleFilter").advansedFilter(null)}var ut=!1,d=!0,r=null,u=[],n=[],f=1,e=1,s={},i,bt=function(n){var t=jq(this);peopleActions.callMethodByClassname(t.attr("class"),this,[n,t]);jq(document.body).trigger("click")},ei=function(){if(ut!==!1)return undefined;ut=!0;i=ASC.People.PageNavigator.pgNavigator;vt();fi();pr();ui();k();wr();br();ri();ASC.Controls.AnchorController.bind(ti)},st=function(n){for(var i={},t=null,r=0,u=n.length;r<u;r++){t=n[r];switch(t.id){case"sorter":i.sortorder=t.params.sortOrder;break;case"text":i.query=encodeURIComponent(t.params.value);break;case"selected-status-active":case"selected-status-disabled":case"selected-status-pending":i.status=t.params.value;break;case"selected-type-admin":case"selected-type-user":case"selected-type-visitor":i.type=t.params.value;break;case"selected-group":i.group=t.params.id}}return i},oi=function(n,t,r,u,f){i.CurrentPageNumber=1;o(1,"pageOfProfilesList");l();var e=ASC.Controls.AnchorController.getAnchor(),s=st(f);r.id==="text"&&(e=jq.removeParam("p",e),e=jq.removeParam("c",e));e=jq.anchorToObject(e);s=jq.mergeAnchors(e,s);jq.isEqualAnchors(s,e)||ASC.Controls.AnchorController.move(jq.objectToAnchor(s))},si=function(n,t,u,f){i.CurrentPageNumber=1;o(1,"pageOfProfilesList");l();var s=jq.anchorToObject(ASC.Controls.AnchorController.getAnchor()),e=st(f);return u.id==="text"&&(r=jq.removeParam("query",r)),jq.isEqualAnchors(e,s)||ASC.Controls.AnchorController.move(jq.objectToAnchor(e)),u.id==="text"?tt():void 0},hi=function(){var n=jq.getAnchorParam("group")||null;n!=null&&Teamlab.deleteGroup({},n,{before:function(){LoadingBanner.showLoaderBtn("#confirmationDeleteDepartmentPanel")},after:function(){LoadingBanner.hideLoaderBtn("#confirmationDeleteDepartmentPanel")},success:dt})},ci=function(){i.CurrentPageNumber=1;o(1,"pageOfProfilesList");l();r=jq.removeParam("query",r);ASC.Controls.AnchorController.move("")},li=function(n){i.CurrentPageNumber=n;o(n,"pageOfProfilesList");tt()},ai=function(n){if(!isNaN(n)){var t=n*1;i.EntryCountOnPage=t;o(t,"countOfProfilesList");ASC.People.PeopleController.moveToPage("1")}},o=function(n,t){if(t&&t!=""){var i={key:n};jq.cookies.set(t,i,{path:location.pathname})}},kr=function(){var t=911,n;jq(window).width()>1200&&(t=jq(window).width()-330);n=t-defaultSize.mainContent;n=n>0?n:0;jq("#SubTasksBody .taskList .taskPlace .taskName").each(function(){var t=defaultSize.taskRowEntryTitleName;jq(this).css("max-width",t+n+"px")})},vi=function(){jq("#peopleHeaderMenu").show();jq(window).scroll()},ht=function(){jq("#peopleHeaderMenu").find(".menuChangeType, .menuChangeStatus, .menuSendInvite, .menuRemoveUsers, .menuWriteLetter").removeClass("unlockAction").unbind("click");jq("#changeTypePanel, #changeStatusPanel").hide()},c=function(){var s=0,h=0,r=0,c=0,l=1,a=1,v=1,y=1,u=jq("#peopleHeaderMenu .menuChangeType"),f=jq("#peopleHeaderMenu .menuChangeStatus"),w=jq("#changeTypePanel"),b=jq("#changeStatusPanel"),e=jq("#peopleHeaderMenu .menuSendInvite"),o=jq("#peopleHeaderMenu .menuRemoveUsers"),k=jq("#peopleHeaderMenu .menuWriteLetter"),i,p,t;if(n.length===0){ht();return}for(i=0,p=n.length;i<p;i++)t=n[i],r++,t.isTerminated?t.isLDAP||c++:(t.isAdmin||t.listAdminModules.length||t.isPortalOwner||h++,t.isActivated||t.isLDAP||t.isSSO||s++),t.isVisitor?a--:l--,t.isTerminated?y--:v--,(t.isPortalOwner||t.isLDAP)&&r--;k.addClass("unlockAction");f.hasClass("unlockAction")||f.addClass("unlockAction");r>0?(b.find(".dropdown-item").removeClass("disable"),v>0&&jq("#changeStatusPanel ul li:last-child a").addClass("disable"),y>0&&jq("#changeStatusPanel ul li:first-child a").addClass("disable")):f.removeClass("unlockAction");u.hasClass("unlockAction")||u.addClass("unlockAction");h>0?(w.find(".dropdown-item").removeClass("disable"),l>0&&jq("#changeTypePanel ul li:last-child a").addClass("disable"),a>0&&jq("#changeTypePanel ul li:first-child a").addClass("disable")):u.removeClass("unlockAction");s>0?e.hasClass("unlockAction")||e.addClass("unlockAction"):e.removeClass("unlockAction");c>0?o.hasClass("unlockAction")||o.addClass("unlockAction"):o.removeClass("unlockAction")},yi=function(t){for(var s,i,f,o=jq(t).is(":checked"),e=[],r=0,h=n.length;r<h;r++)e.push(n[r].id);for(r=0,s=u.length;r<s;r++)i=u[r],f=jq.inArray(i.id,e),o&&f==-1&&(n.push(i),e.push(i.id),jq("#user_"+i.id).addClass("selected"),jq("#checkUser_"+i.id).prop("checked",!0)),o||f==-1||(n.splice(f,1),e.splice(f,1),jq("#user_"+i.id).removeClass("selected"),jq("#checkUser_"+i.id).prop("checked",!1));it(n.length);c()},pi=function(){var n=jq(this).attr("id").split("_")[1].trim();ct(n,!jq("#checkUser_"+n).is(":checked"))},wi=function(n){var t=jq(this).attr("id").split("_")[1].trim();ct(t,this.checked);n||(n=window.event);n.cancelBubble=!0;n.stopPropagation&&n.stopPropagation()},ct=function(t,i){for(var s,f,e=null,r=0,o=u.length;r<o;r++)t==u[r].id&&(e=u[r]);for(s=[],r=0,o=n.length;r<o;r++)s.push(n[r].id);f=jq.inArray(t,s);jq("#checkUser_"+t).prop("checked",i===!0);i?(jq("#user_"+t).addClass("selected"),f==-1&&e!=null&&n.push(e),lt()):(jq("#mainSelectAll").prop("checked",!1),jq("#user_"+t).removeClass("selected"),f!=-1&&n.splice(f,1));it(n.length);c()},l=function(){n=[];jq("#peopleData input:checkbox").prop("checked",!1);jq("#mainSelectAll").prop("checked",!1);jq("#peopleData tr.selected").removeClass("selected");it(n.length);ht()},lt=function(){var n=jq("#peopleData tbody tr").length,t=jq("#peopleData input[id^=checkUser_]:checked").length;jq("#mainSelectAll").prop("checked",n==t)},it=function(n){n>0?(jq("#peopleHeaderMenu .menu-action-checked-count > span").text(jq.format(PeopleManager.SelectedCount,n)),jq("#peopleHeaderMenu .menu-action-checked-count").show()):(jq("#peopleHeaderMenu .menu-action-checked-count > span").text(""),jq("#peopleHeaderMenu .menu-action-checked-count").hide())},bi=function(){jq("#peopleHeaderMenu .menu-action-simple-pagenav").html("");var n=jq("<div><\/div>"),t=0,i=jq("#tableForPeopleNavigation .pagerPrevButtonCSSClass"),r=jq("#tableForPeopleNavigation .pagerNextButtonCSSClass");i.length!=0&&(t++,i.clone().appendTo(n));r.length!=0&&(t++,t===2&&jq("<span style='padding: 0 8px;'>&nbsp;<\/span>").clone().appendTo(n),r.clone().appendTo(n));n.children().length!=0?(n.appendTo("#peopleHeaderMenu .menu-action-simple-pagenav"),jq("#peopleHeaderMenu .menu-action-simple-pagenav").show()):jq("#peopleHeaderMenu .menu-action-simple-pagenav").hide()},ki=function(n){jq("#changeTypePanel").hide();var t=parseInt(jq(n).attr("data-type"));di(t);StudioBlockUIManager.blockUI("#changeTypeDialog",500,220,0);PopupKeyUpActionProvider.ClearActions();PopupKeyUpActionProvider.EnterAction='jq("#changeTypeDialogOk").click();'},di=function(n){var r;f=n;var i=jq("#changeTypeDialog"),u=jq("#changeTypeDialog .user-list-for-group-operation"),e=gi();t(i);b(i);a(e,u);jq("#changeTypeDialogTariff").hide();jq("#changeTypeDialogOk").removeClass("gray").addClass("blue");jq("#userTypeInfo .action-info").removeClass("display-none");jq("#changeTypeDialog .selected-users-info").removeClass("display-none");f==1?(jq("#userTypeInfo").removeClass("display-none"),jq("#visitorTypeInfo").addClass("display-none"),jq("#changeTypeDialogTariff").length&&(jq("#changeTypeDialogTariff").show(),jq("#changeTypeDialogTariff~#changeTypeDialogOk").length&&jq("#changeTypeDialogOk").removeClass("blue").addClass("gray")),r=s.availableUsersCount,jq("#userTypeInfo .tariff-limit").html(jq.format(PeopleManager.UserLimit,"<b>",r,"<\/b>")),at(u,r),r==0&&(jq("#userTypeInfo .action-info").addClass("display-none"),jq("#changeTypeDialog .selected-users-info").addClass("display-none"))):f==2&&(jq("#userTypeInfo").addClass("display-none"),jq("#visitorTypeInfo").removeClass("display-none"));i.find("input[disabled]").length==i.find("input").length?jq("#changeTypeDialogOk").addClass("disable"):jq("#changeTypeDialogOk").removeClass("disable")},gi=function(){for(var t,i=jq.extend(!0,[],n),r=0,u=i.length;r<u;r++)t=i[r],(t.isPortalOwner||t.isAdmin||t.isMe)&&(t.locked=!0),t.listAdminModules.length&&(t.locked=!0),t.isTerminated&&(t.locked=!0),f!=1||t.isVisitor||(t.locked=!0),f==2&&t.isVisitor&&(t.locked=!0);return i},nr=function(){var n=jq("#changeTypeDialog"),r=jq("#changeTypeDialog .user-list-for-group-operation"),i=y(r),u={userIds:i};if(i.length==0)return jq.unblockUI(),!1;Teamlab.updateUserType({},f,u,{success:function(i,r){var u=h(r);rt(i,u);jq("#changeTypePanel .dropdown-item").removeClass("disable");jq("#changeTypePanel .dropdown-item[data-type="+f+"]").addClass("disable");t(n);jq.unblockUI();toastr.success(ASC.People.Resources.PeopleJSResource.SuccessChangeUserType);k()},error:function(i,r){t(n);w(n,r)},after:function(){t(n)},before:function(){p(n)}})},tr=function(n){jq("#changeStatusPanel").hide();var t=parseInt(jq(n).attr("data-status"));ir(t);StudioBlockUIManager.blockUI("#changeStatusDialog",650,300,0);PopupKeyUpActionProvider.ClearActions();PopupKeyUpActionProvider.EnterAction='jq("#changeStatusOkBtn").click();'},ir=function(n){var i;e=n;var r=jq("#changeStatusDialog"),u=jq("#changeStatusDialog .user-list-for-group-operation"),f=rr();t(r);b(r);a(f,u);jq("#changeStatusTariff").hide();jq("#changeStatusOkBtn").removeClass("gray").addClass("blue");jq("#activeStatusInfo .action-info").removeClass("display-none");jq("#changeStatusDialog .selected-users-info").removeClass("display-none");e==1?(jq("#activeStatusInfo").removeClass("display-none"),jq("#terminateStatusInfo").addClass("display-none"),jq("#changeStatusTariff").length&&(jq("#changeStatusTariff").show(),jq("#changeStatusTariff~#changeStatusOkBtn").length&&jq("#changeStatusOkBtn").removeClass("blue").addClass("gray")),i=s.availableUsersCount,jq("#activeStatusInfo .tariff-limit").html(jq.format(PeopleManager.UserLimit,"<b>",i,"<\/b>")),at(u,i),i==0&&(jq("#activeStatusInfo .action-info").addClass("display-none"),jq("#changeStatusDialog .selected-users-info").addClass("display-none"))):e==2&&(jq("#activeStatusInfo").addClass("display-none"),jq("#terminateStatusInfo").removeClass("display-none"))},rr=function(){for(var t,i=jq.extend(!0,[],n),r=0,u=i.length;r<u;r++)t=i[r],(t.isPortalOwner||t.isMe||t.isLDAP)&&(t.locked=!0),e!=1||t.isTerminated||(t.locked=!0),e==2&&t.isTerminated&&(t.locked=!0);return i},ur=function(){var n=jq("#changeStatusDialog"),r=jq("#changeStatusDialog .user-list-for-group-operation"),i=y(r),u={userIds:i};if(i.length==0)return jq.unblockUI(),!1;Teamlab.updateUserStatus({},e,u,{success:function(i,r){var u=h(r);rt(i,u);t(n);jq.unblockUI();c();toastr.success(ASC.People.Resources.PeopleJSResource.SuccessChangeUserStatus);k()},error:function(i,r){t(n);w(n,r)},after:function(){t(n)},before:function(){p(n)}})},fr=function(){jq("#changeTypePanel, #changeStatusPanel, #otherFunctionCnt").hide();er();StudioBlockUIManager.blockUI("#resendInviteDialog",500,350,0);PopupKeyUpActionProvider.ClearActions();PopupKeyUpActionProvider.EnterAction='jq("#resendInviteDialog .button.blue").click();'},er=function(){var n=jq("#resendInviteDialog"),i=jq("#resendInviteDialog .user-list-for-group-operation"),r=or();t(n);b(n);a(r,i)},or=function(){for(var t,i=jq.extend(!0,[],n),r=0,u=i.length;r<u;r++)t=i[r],(t.isActivated||t.isTerminated||t.isLDAP||t.isSSO)&&(t.locked=!0);return i},sr=function(){var n=jq("#resendInviteDialog"),r=jq("#resendInviteDialog .user-list-for-group-operation"),i=y(r),u={userIds:i};if(i.length==0)return jq.unblockUI(),!1;Teamlab.sendInvite({},u,{success:function(){t(n);jq.unblockUI();toastr.success(ASC.People.Resources.PeopleJSResource.SuccessSendInvitation)},error:function(i,r){t(n);w(n,r)},after:function(){t(n)},before:function(){p(n)}})},hr=function(){jq("#changeTypePanel, #changeStatusPanel, #otherFunctionCnt").hide();cr();StudioBlockUIManager.blockUI("#deleteUsersDialog",500,200,0);PopupKeyUpActionProvider.ClearActions();PopupKeyUpActionProvider.EnterAction='jq("#deleteUsersDialog .button.blue").click();'},cr=function(){var n=jq("#deleteUsersDialog"),i=jq("#deleteUsersDialog .user-list-for-group-operation"),r=lr();t(n);b(n);a(r,i)},lr=function(){for(var t,i=jq.extend(!0,[],n),r=0,u=i.length;r<u;r++)t=i[r],(!t.isTerminated||t.isLDAP)&&(t.locked=!0);return i},ar=function(){var n=jq("#deleteUsersDialog"),r=jq("#deleteUsersDialog .user-list-for-group-operation"),i=y(r),u={userIds:i};if(i.length==0)return jq.unblockUI(),!1;Teamlab.removeUsers({},u,{success:function(){t(n);jq.unblockUI();window.location.reload(!0)},error:function(i,r){t(n);w(n,r)},after:function(){t(n)},before:function(){p(n)}})},vr=function(){var i,r,t,u;for(jq("#changeTypePanel, #changeStatusPanel, #otherFunctionCnt").hide(),i=jq.extend(!0,[],n),r=[],t=0,u=i.length;t<u;t++)r.push(i[t].email);window.open("../../addons/mail/#composeto/email="+r.join(),"_blank")},rt=function(t,i){for(var r,s,f,c,e,l,o=0,h=i.length;o<h;o++){for(r=i[o],r.isChecked=!0,s=jq.tmpl("userListTemplate",{users:[r],isAdmin:Teamlab.profile.isAdmin||window.ASC.Resources.Master.IsProductAdmin}),jq("#user_"+r.id).replaceWith(s),f=0,c=u.length;f<c;f++)r.id==u[f].id&&(u[f]=r);for(e=0,l=n.length;e<l;e++)r.id==n[e].id&&(n[e]=r);ft(jq(s))}},a=function(n,t){var i=jq(t);i.html("");i.off("click","input[type=checkbox]");jq(n).each(function(n,t){var f=jq("<div/>"),u=jq("<label/>"),r=jq("<input/>");r.attr("type","checkbox");r.attr("user-id",t.id);r.attr("user-isVisitor",t.isVisitor);t.locked?(r.attr("locked",t.id).prop("checked",!1).attr("disabled",!0),u.addClass("gray-text")):r.prop("checked",!0).attr("disabled",!1);u.html(t.displayName);r.prependTo(u);u.appendTo(f);f.appendTo(i)})},at=function(n,t){if(typeof t!="undefined"&&t!=null){var r=jq(n),i=0;r.find("input[type=checkbox]").each(function(r,u){var f=jq(u);f.attr("locked")?f.prop("checked",!1).attr("disabled",!0):i<t||i==t&&n.parents("#changeStatusDialog").length&&f.attr("user-isvisitor")=="true"?(f.prop("checked",!0).attr("disabled",!1),i++):f.prop("checked",!1).attr("disabled",!0)});r.on("click","input[type=checkbox]",function(){yr(this,n,t)})}},yr=function(n,t,i){var r=jq(t).find("input[type=checkbox]"),u=jq(t).find("input[type=checkbox]:checked").length;jq(n).is(":checked")?(u>i&&jq(n).prop("checked",!1),u==i&&r.each(function(n,t){jq(t).is(":checked")||jq(t).attr("disabled",!0)})):r.each(function(n,t){var i=jq(t);i.attr("locked")?i.prop("checked",!1).attr("disabled",!0):i.attr("disabled",!1)})},v=function(n){var t=jq(n).parents("div.containerBodyBlock:first"),r=t.find("a.showBtn"),u=t.find("a.hideBtn"),i=t.find("div.user-list-for-group-operation");i.hasClass("display-none")?(r.addClass("display-none"),u.removeClass("display-none"),i.removeClass("display-none")):(r.removeClass("display-none"),u.addClass("display-none"),i.addClass("display-none"))},y=function(n){var i=jq(n).find("input[type=checkbox]:checked"),t=[];return i.each(function(n,i){var r=jq(i).attr("user-id").trim();t.push(r)}),t},p=function(n){LoadingBanner.showLoaderBtn(n);jq(n).find("input[type=checkbox]").attr("disabled",!0)},t=function(n){LoadingBanner.hideLoaderBtn(n);jq(n).find("input[type=checkbox]").each(function(){jq(this).attr("locked")||jq(this).attr("disabled",!1)})},w=function(n,t){jq(n).find(".error-popup").html(t).removeClass("display-none")},b=function(n){jq(n).find(".error-popup").html("").addClass("display-none")},pr=function(){var n=[];Teamlab.profile.isAdmin||window.ASC.Resources.Master.IsProductAdmin?n.push({type:"combobox",id:"selected-status-active",title:ASC.People.Resources.PeopleJSResource.LblActive,filtertitle:ASC.People.Resources.PeopleJSResource.LblStatus,group:ASC.People.Resources.PeopleJSResource.LblStatus,groupby:"selected-profile-status-value",options:[{value:"active",classname:"active",title:ASC.People.Resources.PeopleJSResource.LblActive,def:!0},{value:"disabled",classname:"disabled",title:ASC.People.Resources.PeopleJSResource.LblTerminated},{value:"pending",classname:"pending",title:ASC.People.Resources.PeopleJSResource.LblPending}],hashmask:"type/{0}"},{type:"combobox",id:"selected-status-disabled",title:ASC.People.Resources.PeopleJSResource.LblTerminated,filtertitle:ASC.People.Resources.PeopleJSResource.LblStatus,group:ASC.People.Resources.PeopleJSResource.LblStatus,groupby:"selected-profile-status-value",options:[{value:"active",classname:"active",title:ASC.People.Resources.PeopleJSResource.LblActive},{value:"disabled",classname:"disabled",title:ASC.People.Resources.PeopleJSResource.LblTerminated,def:!0},{value:"pending",classname:"pending",title:ASC.People.Resources.PeopleJSResource.LblPending}],hashmask:"type/{0}"},{type:"combobox",id:"selected-status-pending",title:ASC.People.Resources.PeopleJSResource.LblPending,filtertitle:ASC.People.Resources.PeopleJSResource.LblStatus,group:ASC.People.Resources.PeopleJSResource.LblStatus,groupby:"selected-profile-status-value",options:[{value:"active",classname:"active",title:ASC.People.Resources.PeopleJSResource.LblActive},{value:"disabled",classname:"disabled",title:ASC.People.Resources.PeopleJSResource.LblTerminated},{value:"pending",classname:"pending",title:ASC.People.Resources.PeopleJSResource.LblPending,def:!0}],hashmask:"type/{0}"}):n.push({type:"combobox",id:"selected-status-pending",title:ASC.People.Resources.PeopleJSResource.LblPending,filtertitle:ASC.People.Resources.PeopleJSResource.LblStatus,group:ASC.People.Resources.PeopleJSResource.LblStatus,groupby:"selected-profile-status-value",options:[{value:"pending",classname:"pending",title:ASC.People.Resources.PeopleJSResource.LblPending,def:!0}],hashmask:"type/{0}"});n.push({type:"combobox",id:"selected-type-admin",title:ASC.Resources.Master.Admin,filtertitle:ASC.People.Resources.PeopleJSResource.LblByType,group:ASC.People.Resources.PeopleJSResource.LblByType,groupby:"selected-profile-type-value",options:[{value:"admin",classname:"admin",title:ASC.Resources.Master.Admin,def:!0},{value:"user",classname:"user",title:ASC.Resources.Master.User},{value:"visitor",classname:"visitor",title:ASC.Resources.Master.Guest}],hashmask:"type/{0}"},{type:"combobox",id:"selected-type-user",title:ASC.Resources.Master.User,filtertitle:ASC.People.Resources.PeopleJSResource.LblByType,group:ASC.People.Resources.PeopleJSResource.LblByType,groupby:"selected-profile-type-value",options:[{value:"admin",classname:"admin",title:ASC.Resources.Master.Admin},{value:"user",classname:"user",title:ASC.Resources.Master.User,def:!0},{value:"visitor",classname:"visitor",title:ASC.Resources.Master.Guest}],hashmask:"type/{0}"},{type:"combobox",id:"selected-type-visitor",title:ASC.Resources.Master.Guest,filtertitle:ASC.People.Resources.PeopleJSResource.LblByType,group:ASC.People.Resources.PeopleJSResource.LblByType,groupby:"selected-profile-type-value",options:[{value:"admin",classname:"admin",title:ASC.Resources.Master.Admin},{value:"user",classname:"user",title:ASC.Resources.Master.User},{value:"visitor",classname:"visitor",title:ASC.Resources.Master.Guest,def:!0}],hashmask:"type/{0}"},{type:"group",id:"selected-group",title:ASC.Resources.Master.Department,group:ASC.People.Resources.PeopleJSResource.LblOther,hashmask:"group/{0}"});ASC.People.PeopleController.advansedFilter=jq("#peopleFilter").advansedFilter({maxfilters:-1,anykey:!1,store:!1,hintDefaultDisable:!0,sorters:[{id:"by-name",title:ASC.People.Resources.PeopleJSResource.LblByName,dsc:!1,def:!0}],filters:n}).bind("setfilter",ASC.People.PeopleController.setFilter).bind("resetfilter",ASC.People.PeopleController.resetFilter).bind("resetallfilters",ASC.People.PeopleController.resetAllFilters);PeopleManager.SelectedCount=ASC.People.Resources.PeopleJSResource.SelectedCount;PeopleManager.UserLimit=ASC.People.Resources.PeopleJSResource.TariffActiveUserLimit;ASC.People.PeopleController.advansedFilter.one("adv-ready",function(){var n=jq("#peopleFilter .advansed-filter-list");n.find("li[data-id='selected-status-active'] .inner-text").trackEvent(ga_Categories.people,ga_Actions.filterClick,"status_active");n.find("li[data-id='selected-status-disabled'] .inner-text").trackEvent(ga_Categories.people,ga_Actions.filterClick,"status_disabled");n.find("li[data-id='selected-status-pending'] .inner-text").trackEvent(ga_Categories.people,ga_Actions.filterClick,"status_pending");n.find("li[data-id='selected-type-admin'] .inner-text").trackEvent(ga_Categories.people,ga_Actions.filterClick,"type_admin");n.find("li[data-id='selected-type-user'] .inner-text").trackEvent(ga_Categories.people,ga_Actions.filterClick,"type_user");n.find("li[data-id='selected-type-visitor'] .inner-text").trackEvent(ga_Categories.people,ga_Actions.filterClick,"type_visitor");n.find("li[data-id='selected-group'] .inner-text").trackEvent(ga_Categories.people,ga_Actions.filterClick,"group")});jq(".people-import-banner_img").trackEvent(ga_Categories.people,ga_Actions.bannerClick,"import-people");jq("#peopleFilter .btn-toggle-sorter").trackEvent(ga_Categories.people,ga_Actions.filterClick,"sort");jq("#peopleFilter .advansed-filter-input").trackEvent(ga_Categories.people,ga_Actions.filterClick,"search_text","enter")},k=function(){Teamlab.getQuotas({},{success:function(n,t){s=t},error:function(){}})},wr=function(){ScrolledGroupMenu.init({menuSelector:"#peopleHeaderMenu",menuAnchorSelector:"#mainSelectAll",menuSpacerSelector:"#peopleContent .header-menu-spacer",userFuncInTop:function(){jq("#peopleHeaderMenu .menu-action-on-top").hide()},userFuncNotInTop:function(){jq("#peopleHeaderMenu .menu-action-on-top").show()}})},br=function(){jq.dropdownToggle({dropdownID:"changeTypePanel",switcherSelector:"#peopleHeaderMenu .menuChangeType.unlockAction",addTop:4,addLeft:0});jq.dropdownToggle({dropdownID:"changeStatusPanel",switcherSelector:"#peopleHeaderMenu .menuChangeStatus.unlockAction",addTop:4,addLeft:0});jq("#peopleHeaderMenu").on("click",".menuSendInvite.unlockAction",function(){return fr(),!1});jq("#peopleHeaderMenu").on("click",".menuRemoveUsers.unlockAction",function(){return hr(),!1});jq("#peopleHeaderMenu").on("click",".menuWriteLetter.unlockAction",function(){return vr(),!1});jq("#peopleHeaderMenu").on("click","#mainDeselectAll",function(){return l(),!1});jq("#peopleHeaderMenu").on("click",".on-top-link",function(){return window.scrollTo(0,0),!1});jq("#changeTypePanel").on("click","a.dropdown-item:not(.disable)",function(){return ki(this),!1});jq("#changeStatusPanel").on("click","a.dropdown-item:not(.disable)",function(){return tr(this),!1});jq("#changeTypeDialog").on("click","a.showBtn, a.hideBtn",function(){return v(this),!1});jq("#changeTypeDialog").on("click","#changeTypeDialogOk:not(.disable)",function(){return nr(),!1});jq("#changeTypeDialog").on("click","#changeTypeDialogCancel:not(.disable)",function(){return jq.unblockUI(),!1});jq("#changeStatusDialog").on("click","a.showBtn, a.hideBtn",function(){return v(this),!1});jq("#changeStatusDialog").on("click","#changeStatusOkBtn:not(.disable)",function(){return ur(),!1});jq("#changeStatusDialog").on("click","#changeStatusCancelBtn:not(.disable)",function(){return jq.unblockUI(),!1});jq("#resendInviteDialog").on("click","a.showBtn, a.hideBtn",function(){return v(this),!1});jq("#resendInviteDialog").on("click","a.button.blue:not(.disable)",function(){return sr(),!1});jq("#resendInviteDialog").on("click","a.button.gray:not(.disable)",function(){return jq.unblockUI(),!1});jq("#deleteUsersDialog").on("click","a.showBtn, a.hideBtn",function(){return v(this),!1});jq("#deleteUsersDialog").on("click","a.button.blue:not(.disable)",function(){return ar(),!1});jq("#deleteUsersDialog").on("click","a.button.gray:not(.disable)",function(){return jq.unblockUI(),!1});jq("#tableForPeopleNavigation").on("change","select",function(){ai(this.value)});jq("#peopleData").unbind("contextmenu").bind("contextmenu",function(n){var t=jq.fixEvent(n),r,u,f,i;return typeof t=="undefined"||!t?!0:(r=jq(t.srcElement||t.target),u=r.closest("tr.with-entity-menu"),u.length)?(f=u.attr("id").split("_")[1],ot(f),jq("#peopleData .entity-menu.active").removeClass("active"),i=jq("#peopleActionMenu"),i.show(),i.hide(),jq.showDropDownByContext(t,r,i),!1):!0});jq.dropdownToggle({dropdownID:"otherFunctionCnt",switcherSelector:"#peopleHeaderMenu .otherFunctions",position:"fixed",addTop:5,addLeft:-8})};return{init:ei,setFilter:oi,resetFilter:si,moveToPage:li,resetAllFilters:ci,getEditGroup:ii,deleteGroup:hi,selectAll:yi,selectRow:pi,selectCheckbox:wi}}();jq(document).ready(function(){var n=jq("#peopleData");if(n.length){ASC.People.PeopleController.init();n.on("click",".check-list",ASC.People.PeopleController.selectRow);n.on("click",".checkbox-user",ASC.People.PeopleController.selectCheckbox)}});jQuery.extend({getAnchorParam:function(n,t){var t=t||window.location.href.toLowerCase(),r=new RegExp("[#&]"+n+"=([^&]*)"),i=r.exec("#"+t);return i==null?"":i[1]},hasParam:function(n,t){var i=new RegExp("(\\#|&|^)"+n+"=","g");return i.test(t)},removeParam:function(n,t){if(t==="")return"";var i=new RegExp("(\\#|&|^)"+n+"=([^&]*)");return t.replace(i,"")},addParam:function(n,t,i){return n.length&&(n+="&"),n+t+"="+i},changeParamValue:function(n,t,i){var u=["\\#","&","^"],r,f,e;if(jq.hasParam(t,n)){for(r=0;r<u.length;r++)f=new RegExp(u[r]+t+"[=][0-9a-z-]*"),e=u[r]=="^"?"":u[r],n=n.replace(f,e+t+"="+i);return n}return jq.addParam(n,t,i)},clearUrl:function(){var n=window.location.href;return n.indexOf("#")==-1?n:n.split("#")[0]},mergeAnchors:function(n,t){var r={};for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r},anchorToObject:function(n){var i,t,r;for(n=n.charAt(0)==="#"?n.substring(1):n,i={},n=n.split("&"),t=0,r=n.length;t<r;t++)n[t]=n[t].split("="),n[t].length===2&&(i[n[t][0]]=n[t][1]);return i},objectToAnchor:function(n){var i=[];for(var t in n)n.hasOwnProperty(t)&&i.push(t+"="+n[t]);return i.join("&")},isEqualAnchors:function(n,t){for(var i in n)if(n.hasOwnProperty(i)&&!t.hasOwnProperty(i)||n[i]!==t[i])return!1;for(i in t)if(t.hasOwnProperty(i)&&!n.hasOwnProperty(i)||t[i]!==n[i])return!1;return!0}});String.prototype.htmlEncode=function(){return jQuery(document.createElement("div")).text(this.toString()).html()};typeof ASC=="undefined"&&(ASC={});ASC.People=ASC.People||{};ASC.People.model=ASC.People.model||{};ASC.People.eventSource={document:"document",filter:"filter",anchor:"anchor",navigator:"navigator"};ASC.People.model.groups=ASC.People.model.groups||[];ASC.People.model.profiles=ASC.People.model.profiles||[];ASC.People.eventHandler={create:function(n,t){return t.prototype={source:n,handle:function(n,t){this.source&&this.source===t.source||typeof this[n]=="function"&&this[n](t)}},new t}};ASC.People.controller={registryHandler:function(n){this.subscribers[this.subscribers.length]=n},publish:function(n,t,i){for(var r=0,u=this.subscribers.length;r<u;r++)typeof this.subscribers[r].handle=="function"&&this.subscribers[r].handle(t,i)},make:function(n,t){var i,r;for(i in this)n.prototype[i]=this[i];if(n.prototype.subscribers=[],typeof t=="object"&&typeof t.length!="undefined")for(i=0,r=t.length;i<r;i++)n.prototype.subscribers.push(t[i]);else typeof views=="object"&&n.prototype.subscribers.push(t);return new n}};DepartmentManagement=new function(){this._groupId=null;this._deleteGroup="";this.isInitHeadSelector=!1;this.isInitMembersSelector=!1;this.initDepartmentDialog=function(){var t=jq("#headAdvancedSelector"),n=jq("#membersAdvancedSelector"),i;if(DepartmentManagement.isInitMembersSelector)n.useradvancedSelector("reset");else{i=jq("#departmentManager .result-name").attr("data-id");DepartmentManagement.isInitMembersSelector=!0;n.useradvancedSelector({itemsDisabledIds:i.length?[i]:[],canadd:!0,showGroups:!0,inPopup:!0}).on("showList",function(n,t){var r=jq.tmpl("template-selector-selected-items",{Items:t}),i;jq("#membersDepartmentList").html(r);i=[];t.forEach(function(n){i.push(n.id)})});jq("#membersDepartmentList").on("click","li .reset-icon:not(.disabled)",function(){var i=jq(this),t=i.parents("li");n.useradvancedSelector("unselect",[t.attr("data-id")]);t.remove()})}if(DepartmentManagement.isInitHeadSelector)t.useradvancedSelector("reset");else{DepartmentManagement.isInitHeadSelector=!0;t.useradvancedSelector({canadd:!0,showGroups:!0,onechosen:!0,inPopup:!0,withGuests:!1}).on("showList",function(t,i){var r=jq("#departmentManager"),u=r.find(".result-name").attr("data-id");n.useradvancedSelector("undisable",u.length?[u]:[]);n.useradvancedSelector("disable",[i.id]);jq("#membersDepartmentList li[data-id="+i.id+"]").remove();r.find(".result-name").attr("data-id",i.id).html(i.title);r.removeClass("display-none");jq(this).hide()});jq("#departmentManager").find(".reset-icon").on("click",function(){jq(this).hasClass("disabled")||(n.useradvancedSelector("undisable",[jq("#departmentManager .result-name").attr("data-id")]),jq("#departmentManager").addClass("display-none"),jq("#departmentManager .result-name").attr("data-id","").text(""),t.show())})}};this.AddDepartmentOpenDialog=function(){HideRequiredError();DepartmentManagement.initDepartmentDialog();StudioBlockUIManager.blockUI("#studio_departmentAddDialog",400,300,0);jq("#studio_departmentAddDialog .infoPanel").hide();jq("#studio_newDepName").val("");jq("#headAdvancedSelector").show();jq("#departmentManager").addClass("display-none");jq("#departmentManager .result-name").text("");jq("#membersDepartmentList li").remove();jq("#membersAdvancedSelector").useradvancedSelector("reset");this._groupId=null;jq("#studio_departmentAddDialog .grouptitle").html(ASC.Resources.Master.AddDepartmentHeader);jq("#studio_departmentAddDialog .middle-button-container a.blue").html(ASC.Resources.Master.Resource.AddButton);PopupKeyUpActionProvider.ClearActions();PopupKeyUpActionProvider.EnterAction="DepartmentManagement.AddDepartmentCallback()"};this.EditDepartmentOpenDialog=function(n,t,i){var r,u,f,e,o;HideRequiredError();DepartmentManagement.initDepartmentDialog();StudioBlockUIManager.blockUI("#studio_departmentAddDialog",400,300,0);jq("#studio_departmentAddDialog .infoPanel").hide();PopupKeyUpActionProvider.ClearActions();PopupKeyUpActionProvider.EnterAction="DepartmentManagement.AddDepartmentCallback()";this._groupId=n;jq("#studio_departmentAddDialog .grouptitle").html(ASC.Resources.Master.EditDepartmentHeader);jq("#studio_departmentAddDialog .middle-button-container .blue").html(ASC.Resources.Master.Resource.EditButton);jq("#studio_newDepName").val(t);r=jq("#headAdvancedSelector");u=jq("#membersAdvancedSelector");i.id&&i.id!=="4a515a15-d4d6-4b8e-828e-e0586f18f3a3"&&(f=jq("#departmentManager"),f.find(".result-name").attr("data-id",i.id).html(i.displayName),f.removeClass("display-none"),r.hide(),r.useradvancedSelector("select",i.id),u.useradvancedSelector("disable",[i.id]));e=jq(".members-dep-list");o={groupId:n};Teamlab.getProfilesByFilter({},{filter:o,before:function(){jq("#membersDepartmentList").html("");e.append('<div class="loading-link">'+ASC.Resources.Master.Resource.LoadingPleaseWait+"<\/div>")},after:function(){e.find(".loading-link").remove()},success:function(n,t){var r,f,e;t.length&&(r=[],f=[],t.forEach(function(n){r.push(n.id);n.id!==i.id&&f.push({id:n.id,title:n.displayName})}),u.useradvancedSelector("select",r),e=jq.tmpl("template-selector-selected-items",{Items:f.sort(SortData)}),jq("#membersDepartmentList").html(e))}})};this.AddDepartmentCallback=function(){var n,t,i,r;if(!jq("#headAdvancedSelector + .advanced-selector-container").is(":visible")&&!jq("#membersAdvancedSelector + .advanced-selector-container").is(":visible")){if(n=jq("#studio_newDepName"),jq.trim(jq(n).val())===""){ShowRequiredError(n);return}t=jq("#departmentManager .result-name").attr("data-id");i=[];jq("#membersDepartmentList li").each(function(n,t){i.push(jq(t).attr("data-id"))});r={groupManager:t.length?t:"00000000-0000-0000-0000-000000000000",groupName:n.val(),groupId:DepartmentManagement._groupId,members:i};DepartmentManagement.LockDepartmentDialog();DepartmentManagement._groupId==null?Teamlab.addGroup(null,r,{success:function(){DepartmentManagement.CloseAddDepartmentDialog();window.onbeforeunload=null;window.location.reload(!0)},error:function(n,t){DepartmentManagement.UnlockDepartmentDialog();jq("#studio_departmentAddDialog .infoPanel").html("<div>"+t+"<\/div>");jq("#studio_departmentAddDialog .infoPanel").show()}}):Teamlab.updateGroup(null,DepartmentManagement._groupId,r,{success:function(){DepartmentManagement.CloseAddDepartmentDialog();window.location.reload(!0)},error:function(n,t){DepartmentManagement.UnlockDepartmentDialog();jq("#studio_departmentAddDialog .infoPanel").html("<div>"+t+"<\/div>");jq("#studio_departmentAddDialog .infoPanel").show()}})}};this.CloseAddDepartmentDialog=function(){PopupKeyUpActionProvider.ClearActions();jq.unblockUI()};this.LockDepartmentDialog=function(){jq("#headAdvancedSelector, #membersAdvancedSelector, #departmentManager .reset-icon, #membersDepartmentList .reset-icon").addClass("disabled");LoadingBanner.showLoaderBtn("#studio_departmentAddDialog")};this.UnlockDepartmentDialog=function(){jq("#headAdvancedSelector, #membersAdvancedSelector, #departmentManager .reset-icon , #membersDepartmentList .reset-icon").removeClass("disabled");LoadingBanner.hideLoaderBtn("#studio_departmentAddDialog")}};jq(document).ready(function(){jq.tmpl("template-blockUIPanel",{id:"studio_departmentAddDialog",headerTest:ASC.People.Resources.AddDepartmentDlgTitle,headerClass:"grouptitle"}).insertAfter("#peopleSidepanel");jq.tmpl("depAddPopupBodyTemplate",null).appendTo("#studio_departmentAddDialog .containerBodyBlock");jq("#depActionBtn").on("click",".button.blue",function(){DepartmentManagement.AddDepartmentCallback()});jq("#depActionBtn").on("click",".button.gray",function(){DepartmentManagement.CloseAddDepartmentDialog()})});window.peopleActions=function(){var n=function(n,t,i){if((" "+n+" ").indexOf(" disabled ")!==-1)return undefined;for(var r="",f=0,u=typeof n=="string"?n.split(/\s+/):[],f=u?u.length:0;f--;)r=u[f].replace(/-/g,"_"),typeof peopleActions[r]=="function"&&peopleActions[r].apply(t,i)},i=function(n){var t=jq.tmpl("userListTemplate",{users:[n.Data],isAdmin:Teamlab.profile.isAdmin||window.ASC.Resources.Master.IsProductAdmin});jq("#peopleData tr.profile").length==0&&(jq("#emptyContentForPeopleFilter").addClass("display-none"),jq("#peopleContent").removeClass("display-none"));jq("#peopleData").prepend(t);ASC.Controls.AnchorController.trigger()};return{callMethodByClassname:n,add_group:function(){DepartmentManagement.AddDepartmentOpenDialog()},update_group:function(){ASC.People.PeopleController.getEditGroup()},delete_group:function(){jq("#confirmationDeleteDepartmentPanel .confirmationAction").html(jq.format(ASC.Resources.Master.ConfirmRemoveDepartment,"<b>"+jq(".profile-title:first>.header").html()+"<\/b>"));jq("#confirmationDeleteDepartmentPanel .middle-button-container>.button.blue.middle").unbind("click").bind("click",function(){ASC.People.PeopleController.deleteGroup()});StudioBlockUIManager.blockUI("#confirmationDeleteDepartmentPanel",500,200,0);PopupKeyUpActionProvider.ClearActions();PopupKeyUpActionProvider.EnterAction="ASC.People.PeopleController.deleteGroup();"},add_profiles:function(){ImportUsersManager.ShowImportControl("ASC.Controls.AnchorController.trigger()")},send_invites:function(){InvitesResender.Show()},send_email:function(n,t){var r=t.parents("tr.item.profile:first").attr("data-id"),i;r&&(i=t.parents("tr.item.profile:first").attr("data-email"),i&&window.open("../../addons/mail/#composeto/email="+i,"_blank"))},open_dialog:function(n,t){var r=t.parents("tr.item.profile:first").attr("data-id"),i;if(r&&(i=t.parents("tr.item.profile:first").attr("data-username"),i))try{ASC.Controls.JabberClient.open(i)}catch(u){}},invite_link:function(){PopupKeyUpActionProvider.ClearActions();jq("#otherActions").hide();StudioBlockUIManager.blockUI("#inviteLinkContainer",550,350,0);ASC.InvitePanel.bindClipboardEvent()}}}();jq(function(){var n="/products/people/";jq("#groupList .menu-item-label").each(function(t,i){var r=jq(i).parents(".menu-sub-item").attr("data-id");location.pathname!=n&&jq(i).attr("href",n+"#group="+r)});location.pathname!=n&&jq("#defaultLinkPeople").attr("href",n);jq(".people-import-banner_img").on("click",function(){ImportUsersManager.ShowImportControl("ASC.Controls.AnchorController.trigger()")})});typeof ASC=="undefined"&&(ASC={});typeof ASC.People=="undefined"&&(ASC.People=function(){return{}}());ASC.People.Reassigns=function(){function u(){var i=jq("#userSelector");i.useradvancedSelector({itemsChoose:[],itemsDisabledIds:[],canadd:!1,isAdmin:!1,showGroups:!0,withGuests:!1,onechosen:!0});i.on("showList",function(n,t){jq(this).html(t.title);r=t.id;jq("#reassignBtn").removeClass("disable")});jq("#reassignBtn").on("click",function(){jq(this).hasClass("disable")||Teamlab.startReassign({},n,r,{success:function(){t(!1)},before:LoadingBanner.displayLoading,after:LoadingBanner.hideLoading,error:function(n,t){toastr.error(t[0])}})});jq("#terminateBtn").on("click",function(){Teamlab.terminateReassign({},n,{success:function(){window.location.replace(jq("#ancelBtn").attr("href"))},before:LoadingBanner.displayLoading,after:LoadingBanner.hideLoading,error:function(n,t){toastr.error(t[0])}})})}function t(n){n?(jq("#reassignActionContainer").removeClass("display-none"),jq("#reassignProgressContainer").addClass("display-none")):(jq("#reassignActionContainer").addClass("display-none"),jq("#reassignProgressContainer").removeClass("display-none"))}function f(){Teamlab.getReassignProgress({},n,{success:function(n,i){i&&i.hasOwnProperty("isCompleted")?t(i.isCompleted):t(!0)},before:LoadingBanner.displayLoading,after:LoadingBanner.hideLoading,error:function(n,i){t(!0);toastr.error(i[0])}})}function e(t){t&&!i&&(n=t,u(),f(),i=!0)}var i=!1,n=null,r=null;return{init:e}}(),function(n){function t(n){var t=jq(this);peopleActions.callMethodByClassname(t.attr("class"),this,[n,t]);jq(document.body).trigger("click")}function r(t,r){var f=n("#peopleSidepanel"),o=ASC.People.Resources.PeopleJSResource.People,e;r=r||"@persons";jq(".profile-title .menu-small").hide();jq(".profile-title .header").html(o);jq(".profile-title .header").attr("title",o);switch(r){case"@persons":document.title=i;f.find("li.menu-sub-item.active").removeClass("active");f.find("li.menu-item").removeClass("active").filter('li[data-id="'+r+'"]:first').addClass("active open");break;case"@clients":break;case"@freelancers":break;default:f.find("li.menu-item.active").removeClass("active");f.find("li.menu-sub-item").removeClass("active").filter('li[data-id="'+r+'"]:first').addClass("active");e=jq(".menu-sub-list li.active a").html();jq(".profile-title .header").html(e).attr("title",e);document.title=u(e)+" - "+o;jq(".profile-title .menu-small").show();jq.dropdownToggle({dropdownID:"actionGroupMenu",switcherSelector:".profile-title .menu-small",addTop:0,addLeft:-11,showFunction:function(n,t){t.is(":hidden")?n.addClass("active"):n.removeClass("active")},hideFunction:function(){jq(".profile-title .menu-small.active").removeClass("active")}})}}function u(t){return n("<div/>").html(t).text()}function f(){n("#peopleSidepanel").find("a.dropdown-item:not(.invite-link)").bind("click",t);jq("#actionGroupMenu").find("a.dropdown-item").bind("click",t);e()}function e(){if(ASC.Clipboard.enable)jq(window).one("onOpenSideNavOtherActions",function(){window.sideNavInviteLinkClip=ASC.Clipboard.destroy(window.sideNavInviteLinkClip);var n=jq("#shareInviteUserLink").val();sideNavInviteLinkClip=ASC.Clipboard.create(n,"sideNavInviteLink",{onComplete:function(){window.peopleActions.invite_link();typeof toastr!="undefined"?toastr.success(ASC.Resources.Master.Resource.LinkCopySuccess):jq("#shareInviteUserLink, #sideNavInviteLink").yellowFade()}})});else jq("#sideNavInviteLink").on("click",function(){window.peopleActions.invite_link()})}function o(){n(window).bind("change-group",r)}var i=document.title;n(function(){f();o()})}(jQuery)